<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Archive Monitor</title>
    <script src="/socket.io/socket.io.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Archive Monitor</h1>
        </div>
        
        <div class="status">
            <div class="connection-status">
                <div class="status-indicator" id="statusIndicator"></div>
                <span id="statusText">接続中...</span>
            </div>
            <div class="message-count">
                受信メッセージ: <span id="messageCount">0</span>
            </div>
            <button class="clear-btn" onclick="clearMessages()">クリア</button>
        </div>
        
        <!-- 受信メッセージタブ -->
        <div id="receiveTab" class="tab-content active">
            <!-- チャット送信フォーム -->
            <div class="chat-form">
                <div class="chat-form-row">
                    <div class="form-group">
                        <label>トピック:</label>
                        <input type="text" id="chatTopic" placeholder="例: a2a/test/chat" value="a2a/mikoto/user/user123/chat">
                    </div>
                    <div class="form-group">
                        <label>QoS:</label>
                        <select id="chatQos">
                            <option value="0">0</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>スピーカーID:</label>
                        <input type="text" id="chatSpeakerId" placeholder="例: user123" value="user123" onchange="setSpeakerId()">
                    </div>
                </div>
                <div class="chat-form-row">
                    <div class="form-group">
                        <label>メッセージ:</label>
                        <textarea id="chatMessage" placeholder="メッセージを入力してください..."></textarea>
                    </div>
                    <div style="display: flex; gap: 10px; align-items: flex-end;">
                        <button class="send-btn" onclick="sendChatMessage()" id="sendChatBtn">送信</button>
                        <button class="voice-btn" onclick="toggleVoiceRecognition()" id="voiceBtn">
                            <svg class="voice-icon" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3z"/>
                                <path d="M17 11c0 2.76-2.24 5-5 5s-5-2.24-5-5H5c0 3.53 2.61 6.43 6 6.92V21h2v-3.08c3.39-.49 6-3.39 6-6.92h-2z"/>
                            </svg>
                            音声認識
                        </button>
                    </div>
                </div>
                <div class="quick-topics">
                    <span>クイックトピック:</span>
                    <button class="quick-topic-btn" onclick="setQuickTopic('chat')">チャット</button>
                    <button class="quick-topic-btn" onclick="setQuickTopic('status')">ステータス</button>
                    <button class="quick-topic-btn" onclick="setQuickTopic('command')">コマンド</button>
                    <button class="quick-topic-btn" onclick="setQuickTopic('notification')">通知</button>
                </div>
            </div>
            
            <!-- フィルター -->
            <div class="filter-controls">
                <div>
                    <label>スピーカーID:</label>
                    <input type="text" id="agentFilter" placeholder="フィルター..." onkeyup="filterMessages()">
                </div>
                <div>
                    <label>ロール:</label>
                    <select id="roleFilter" onchange="filterMessages()">
                        <option value="">すべて</option>
                    </select>
                </div>
                <div>
                    <label>ステータス:</label>
                    <select id="statusFilter" onchange="filterMessages()">
                        <option value="">すべて</option>
                    </select>
                </div>
            </div>
            
            <!-- チャットメッセージ表示 -->
            <div class="chat-container" id="chatContainer">
                <div class="empty-state">
                    <h3>メッセージを待機中...</h3>
                    <p>MQTTメッセージが受信されると、ここに表示されます。</p>
                </div>
            </div>
        </div>
        
        <!-- メッセージ送信タブ -->
        <div id="sendTab" class="tab-content">
            <div class="chat-form">
                <div class="chat-form-row">
                    <div class="form-group">
                        <label>トピック:</label>
                        <input type="text" id="sendTopic" placeholder="例: a2a/test/custom">
                    </div>
                    <div class="form-group">
                        <label>QoS:</label>
                        <select id="sendQos">
                            <option value="0">0</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                        </select>
                    </div>
                </div>
                <div class="chat-form-row">
                    <div class="form-group">
                        <label>ペイロード:</label>
                        <textarea id="sendPayload" placeholder="送信するデータを入力してください..."></textarea>
                    </div>
                    <button class="send-btn" onclick="sendCustomMessage()" id="sendCustomBtn">送信</button>
                </div>
            </div>
        </div>
    </div>
    <script src="index.js"></script>
</body>
</html> 